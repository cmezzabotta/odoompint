<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="account_journal_mercadopago_qr" model="account.journal">
        <field name="name">Mercado Pago QR</field>
        <field name="code">MPQR</field>
        <field name="type">bank</field>
        <field name="company_id" ref="base.main_company"/>
    </record>

    <record id="pos_payment_method_mercadopago_qr" model="pos.payment.method">
        <field name="name">Mercado Pago QR</field>
        <field name="is_cash_count" eval="False"/>
        <field name="split_transactions" eval="False"/>
        <field name="journal_id" ref="account_journal_mercadopago_qr"/>
        <field name="mp_qr_enabled" eval="True"/>
    </record>

    <record id="pos_payment_method_view_form_mezztt_mp_qr" model="ir.ui.view">
        <field name="name">pos.payment.method.view.form.mezztt.mp.qr</field>
        <field name="model">pos.payment.method</field>
        <field name="inherit_id" ref="point_of_sale.pos_payment_method_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet/notebook/page[@name='technical']/group" position="after">
                <page string="Mercado Pago QR" name="mezztt_mp_qr">
                    <group>
                        <group>
                            <field name="mp_qr_enabled"/>
                            <field name="mp_use_global_credentials"/>
                            <field name="mp_qr_mode"/>
                        </group>
                        <group>
                            <field name="mp_notification_url" placeholder="https://..."/>
                        </group>
                    </group>
                    <group string="Credenciales específicas" attrs="{'invisible': [('mp_use_global_credentials', '=', True)]}">
                        <group>
                            <field name="mp_access_token" password="True"/>
                            <field name="mp_public_key"/>
                            <field name="mp_integrator_id"/>
                            <field name="mp_sponsor_id"/>
                        </group>
                        <group>
                            <field name="mp_user_id"/>
                            <field name="mp_collector_id"/>
                            <field name="mp_external_store_id"/>
                            <field name="mp_external_pos_id"/>
                            <field name="mp_pos_id"/>
                        </group>
                    </group>
                    <label string="Cuando &quot;Mercado Pago QR&quot; está activo, el POS mostrará el popup personalizado al pagar."/>
                </page>
            </xpath>
        </field>
    </record>
</odoo>

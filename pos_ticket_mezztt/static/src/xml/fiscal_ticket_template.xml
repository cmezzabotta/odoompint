<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="point_of_sale.OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension">
        <xpath expr="//div[@class='pos-receipt p-2']" position="replace">
            <div class="pos-receipt fiscal-ticket" style="font-size: 12px; max-width: 300px;">
                <div class="fiscal-header" style="text-align: center;">
                    <h2>RÍO HELADOS</h2>
                    <p>CUIT: <t t-esc="props.data.company_cuit"/></p>
                    <p>Punto de Venta: <t t-esc="props.data.pos_branch"/></p>
                    <p>Fecha: <t t-esc="props.data.date"/></p>
                </div>

                <hr/>

                <div class="fiscal-order-info">
                    <p><strong>Orden Nº:</strong> <t t-esc="props.data.name"/></p>
                    <p><strong>Condición IVA:</strong> <t t-esc="props.data.customer_vat_condition or 'Consumidor Final'"/></p>
                </div>

                <hr/>

                <div class="fiscal-products">
                    <t t-foreach="props.data.orderlines" t-as="line" t-key="line.id">
                        <div>
                            <span><t t-esc="line.quantity"/> x <t t-esc="line.product_name"/></span><br/>
                            <span>$<t t-esc="line.price_display"/></span>
                        </div>
                    </t>
                </div>

                <hr/>

                <div class="fiscal-totals">
                    <p><strong>Total sin IVA:</strong> $<t t-esc="props.data.total_without_tax"/></p>
                    <p><strong>IVA:</strong> $<t t-esc="props.data.total_tax"/></p>
                    <p><strong>TOTAL:</strong> $<t t-esc="props.data.total_with_tax"/></p>
                </div>

                <hr/>

                <div class="fiscal-datos">
                    <p><strong>CAE:</strong> <t t-esc="props.data.cae"/></p>
                    <p><strong>Vto. CAE:</strong> <t t-esc="props.data.cae_due_date"/></p>
                    <p><strong>LEY:</strong> 27.743</p>
                </div>

                <div t-if="props.data.qr_afip_base64" style="text-align: center; margin-top: 10px;">
                    <img t-att-src="'data:image/png;base64,%s' % props.data.qr_afip_base64" alt="QR AFIP" style="width: 120px; height: 120px;"/>
                </div>
            </div>
        </xpath>
    </t>
</templates>
